const { expect } = require("chai");

const { verifySig } = require("./verifysig");

describe("verifysig", () => {
  const rawCACert = `-----BEGIN CERTIFICATE-----
MIIFCDCCA3CgAwIBAgIRAKr1mcWwNGLaPD1w5zjuBKswDQYJKoZIhvcNAQELBQAw
gZsxHjAcBgNVBAoTFW1rY2VydCBkZXZlbG9wbWVudCBDQTE4MDYGA1UECwwvcGF1
bG11c3NvQG1hY2Jvb2stcHJvLWRlLXBhdWwuaG9tZSAoUGF1bCBNdXNzbykxPzA9
BgNVBAMMNm1rY2VydCBwYXVsbXVzc29AbWFjYm9vay1wcm8tZGUtcGF1bC5ob21l
IChQYXVsIE11c3NvKTAeFw0xOTEyMjIxMzIwNDBaFw0yOTEyMjIxMzIwNDBaMIGb
MR4wHAYDVQQKExVta2NlcnQgZGV2ZWxvcG1lbnQgQ0ExODA2BgNVBAsML3BhdWxt
dXNzb0BtYWNib29rLXByby1kZS1wYXVsLmhvbWUgKFBhdWwgTXVzc28pMT8wPQYD
VQQDDDZta2NlcnQgcGF1bG11c3NvQG1hY2Jvb2stcHJvLWRlLXBhdWwuaG9tZSAo
UGF1bCBNdXNzbykwggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQCr8L71
cl5Wxx67tzCO3lm1WtLwaIf+eqbWRkfoOhIALAZZP9SeYjsJOI5ENY3j/AYaFpNG
LPRNoRkFKuF5XHC648ybexQN088OZCFVN9k+InXISbbWBAB6PNW6+Pobb72IGiSb
ygQV7HarBqN1L1JHduJmEjfEpSPCh34C8cI6qSrKstLATlAB36v1XP5DiYJYbx5x
w8hn/yyPdujkgjAaTyG8detnnpGbLf9z7fjef874Fto6T6gts8UV26d9mNTn1/gs
1+fVV4KoHZc57reou2DeG2SsCe0zl0hJMBnb5+srb1grmQubdmuKz9aA/+Sc5KTQ
LSXFdo0d0QZjk0Lp2Q86XaWLU1Yn2YaKTKneo61agfDhpfcSJJS3bWUIdYPgyufT
chR4wTAZdfLdaMKS7LR5Jyj4bi6U1RpUc1dhAqmcl2lRATlQApSZPFNQMxtMQ4UF
dqHxZ4SCrhWx3HWbvqKej0lQy26220hDCX++D/dNrBYnfsZFFK9PHl6gZM8CAwEA
AaNFMEMwDgYDVR0PAQH/BAQDAgIEMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0O
BBYEFBU2h1vbv73nbFmEw18jbc+2bbOqMA0GCSqGSIb3DQEBCwUAA4IBgQCgYmeo
Gw1jykFznBjGWsviodcw12lOAJfXxhYJCdsL2x7pWbLKDGga8FDxi66KNH5ahhWl
bhRzMoRbWbT14ey1nOHUbwIR6w/5MZ6rftfOh+CWGNqZZ4O32i6o1SltQ7arSfeW
6K6S0N/KyyRxzjA00uyIywgathhpSix0hu8sG8xfBSsHFfUI5jt38pk6RXXJQ/GR
Gb04E0aAA6Wt5KfOn7FRY2BcH7/7usXv+eZH1eiFQbwlUVMG8oamQXyKeBuBzRHG
AtcExTrn17AElT06jbET0zuCigwTA5eGsUkt9gzK4W2GbdtjoLwvk3Mldv8XlHHc
TYjihznr0Z+EgNuB98unuo1/JnxPBCZ4EfzvJaMEPdN2Fexddr4ilBG4N6uURv49
O1eXkQXqXMz+IOFQJGL/xkpEWMkOtQlJZmqj+KmmcYXEPYU4dK8VAHkoXIGiVkeP
0+cKdGty/fijp4JDZqY14Feosbr8eY3glg7sIozB+nKvxht/CY8eUj++zfE=
-----END CERTIFICATE-----`;

  const rawCert = `-----BEGIN CERTIFICATE-----
MIIDojCCAgqgAwIBAgIQIEBJ8PBtF1Bi19mMwffWMDANBgkqhkiG9w0BAQsFADCB
mzEeMBwGA1UEChMVbWtjZXJ0IGRldmVsb3BtZW50IENBMTgwNgYDVQQLDC9wYXVs
bXVzc29AbWFjYm9vay1wcm8tZGUtcGF1bC5ob21lIChQYXVsIE11c3NvKTE/MD0G
A1UEAww2bWtjZXJ0IHBhdWxtdXNzb0BtYWNib29rLXByby1kZS1wYXVsLmhvbWUg
KFBhdWwgTXVzc28pMB4XDTE5MDYwMTAwMDAwMFoXDTMyMDUxMDA3MDE0OVowVDEn
MCUGA1UEChMebWtjZXJ0IGRldmVsb3BtZW50IGNlcnRpZmljYXRlMSkwJwYDVQQL
DCBwYXVsbXVzc29AcGF1bG11c3NvIChQYXVsIE11c3NvKTBZMBMGByqGSM49AgEG
CCqGSM49AwEHA0IABFmY5R1Ykcnfh5aZqKnRR/EOK9HKVNQKJyTMEsc2aH7DabwS
vVA79O93xadT8A21jMwfZU7DFPHZ2mLVtMx9MxKjczBxMA4GA1UdDwEB/wQEAwIF
oDAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwDAYDVR0TAQH/BAIwADAf
BgNVHSMEGDAWgBQVNodb27+952xZhMNfI23Ptm2zqjARBgNVHREECjAIggZjbGll
bnQwDQYJKoZIhvcNAQELBQADggGBAISLbkYkYU7VZygEtBl2VZjFhDebDL6+75z9
+HZz+SLo6oqlm1sED9XQUUpeInH8qaqpxOPBf0w6KxRw4rmOCMl1Q6KQ5MVLdnFo
d20t93D7hdDxdpbNwcypntRvUT8nLNunYX+0Nwp/axQK6Zsawqvz6ag5D/xyVR7n
uFkhyREVCELIQRT598KzieOO55SNERlqbG+cs7kjC+iWqW3Utbh2BdWkBysnJ/8+
ntuhzp0Sz0xLm6VtcnysoM9F9HnMtumAdEpoC9i/c7CMKLq1qkkZo3VSgCuSDE7D
C9fKqrvEPDzTMuAdyPCb3c5NbIApPE+C6G/uzi1WyzzO9UXcUSj2SCy171+tYxMC
P7Jj31Xv7jPIzF3G+zwb47YdNiPdbf7YxElmPJMUHGCK00G2I3kJHdPbZ/K01It9
sCnAUe0dM6eHXEoFn6IhV1yflEegFZK0hhp/YANg0+iqpfYD004il9c86Qt5E1+F
50Lmx5TgQ1Wh9NAOeNwk3izKoSSN/Q==
-----END CERTIFICATE-----`;

  it("signed", () => {
    expect(
      verifySig(rawCert, rawCACert)
    ).to.equal(true);
  });

  it("not signed", () => {
    expect(
      verifySig(rawCert, rawCert)
    ).to.equal(false);
  });  
});
